# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:
- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего. Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы. В отчете должны учитываться только завершенные заказы.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«months»: [«march»]} 
   - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в течение года.

## Автор решения
Лебкова Марина Дмитриевна

## Описание реализации
Решение представляет собой две небольшие библиотеки: 
- `order` для хранения данных заказа
- `order_analytics` для получения аналитики по всем заказам

Класс `Order` имеет метод `GetMonthName`, который из строки с временем заказа получает месяц и возвращает его название.
Класс `OrderAnalytics` имеет методы `GetMaxSpendingMonth` и `CreateMonthReport`.

`GetMaxSpendingMonth`:
- Проходит по всем заказам. Если текущий заказ имеет статус `COMPLETED`, то добавляет в словаре `"месяц" - "сумма"` для данного месяца сумму заказа.
- При этом, если полученная сумма больше максимальной из всех (`max_amount`), то максимум обновляется.
- После обработки всех заказов проходит по полученному словарю. Если на итерации текущая сумма равна `max_amount`, то к ответу добавляется текущий месяц.
- Возвращает список месяцев с максимальными тратами со стороны пользователей.

`CreateMonthReport`:
- Вызывает метод `GetMaxSpendingMonth`
- Формирует и возвращает строку в формате json с месяцами

## Инструкция по сборке и запуску решения
Требования:
- Пакетный менеджер [conan](https://conan.io/) 
- CMake версии 3.24 и выше
- Компилятор, совместимый со стандартом С++14 и выше


Если conan не был ни разу использован, необходимо определить профиль, например автогенерацией:
```
conan profile detect
```

1. Склонировать репозиторий:
```
git clone https://github.com/hedanta/school2024-test-task1.git
```
2. В данной директории запустить:
Windows:
```
.\build.bat
.\run.bat
```
Linux:
```
./build.sh
./run.sh
```
При этом в папке input должен быть файл `input.json`.

После выполнения вышеуказанных шагов запустится исполняемый файл `test_app.exe`, и в консоль будет выведена строка с отчётом.

Также при наличии Doxygen будет сгенерирована документация в директории doc.