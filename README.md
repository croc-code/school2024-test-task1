# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:
- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего. Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы. В отчете должны учитываться только завершенные заказы.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«months»: [«march»]} 
   - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в течение года.

## Автор решения
Гуренков Максим Сергеевич
## Описание реализации
Для выполнения задачи было решено использовать библиотеки jackson и lombok.  
### Пакет "application"
В пакете `application` находятся классы, реализующие основную логику работы программы: `Main`, `Report` и `ReportGenerator`.
  - В классе `Main`, с помощью библиотеки jackson данными из файла `input.json` инициализируется список объектов типа `Order`, который потом передается на вход статическому методу `generate()` класса `ReportGenerator`. Возвращаемая json-строка выводится на экран.
  - Класс `Report` содержит в себе только одно поле - список месяцев, в которые были произведены наибольшие затраты. Используется для сериализации результата в json формат.
  - Класс `ReportGenerator` отвечает за генерацию отчетов. Содержит один публичный (`generate()`) и два приватных метода (`countEarningsForEachMonth()` и `findMonthsWithMaxEarnings()`).
      + В методе `countEarningsForEachMonth()` создается `Map`, где ключ - порядковый номер месяца (`Integer`), а значение - общая сумма трат в этом месяце (`Double`). В качестве реализации была выбрана коллекция `TreeMap`, так как она поддерживает автоматическую сортировку элементов по ключу в естественном порядке. Далее в цикле выполняется обход массива заказов, и заполняется `Map`.
      + Метод `findMonthsWithMaxEarnings()` отвечает за формирование списка с месяцами, в которые были произведены максимальные затраты.
      + Метод `generate()` использует все перечисленные методы для формирования отчета типа `Report`, после чего с помощью библиотеки jackson сериализуется в json формат.  
### Пакет "data"
В пакете data находятся классы, представляющие из себя объектную модель входных данных: `Order` и `Status`.
   - Класс `Order` содержит все поля, соответствующие аттрибутам элементов входного массива: `userId`, `orderedAt`, `status`, `total`.
   - Перечисление `Status` - тип данных для поля `status` класса `Order`: COMPLETED, CANCELED, CREATED, DELIVERY.
### Пакет "utils"
В пакете `utils` содержится один класс - `LocalDateTimeDeserializer`, необходимый для корректной десериализации даты в поле типа `LocalDateTime` с помощью jackson.
## Инструкция по сборке и запуску решения
- Убедитесь, что у вас установлен maven
- Перейдите в корневую директорию проекта и выполните команду:
```bash
mvn package
```
- В сгенерированной директории `target` будет лежать jar файл `solution-1.0-SNAPSHOT.jar`, который можно запустить с помощью команды:
```bash
java -jar solution-1.0-SNAPSHOT.jar
```
**Обратите внимание, что для корректной работы программы входные данные должны находиться в файле с названием `input.json`, который должен лежать в той же директории, что и jar файл.**