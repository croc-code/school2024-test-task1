# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания

Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята
тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики,
которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой
подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого
технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В
качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках
пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза
содержит следующую информацию:

- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:

- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего.
Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы.
В отчете должны учитываться только завершенные заказы.

Требования к реализации:

1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна
   быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в
   условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
    - {«months»: [«march»]}
    - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если
   месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в
   течение года.

## Автор решения

Володин Валерий Cергеевич

## Описание реализации
Для преобразования JSON-файла в объекты использована библиотека Jackson - https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind
Для работы jackson с Java 8 Date&Time Api использован модуль из - https://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-jsr310
Для подтягивания зависимостей используется Maven.
Реализация содержит:
1.Order - класс, представляющий заказ. Содержит 4 поля, соответствующие данным JSON-файла:

1) userId - идентификатор пользователя.
2) orderedAt - Дата и время заказа.
3) total - сумма заказа.
4) orderStatus - текущий статус заказа.
   Представлены геттеры для данных полей и конструкторы.

2.OrderStatus - enum,представляет перечисление возможных статусов заказа:

1) COMPLETED (Завершенный заказ);
2) CANCELED (Отмененный заказ);
3) CREATED (Созданный заказ, еще не оплаченный);
4) DELIVERY (Созданный и оплаченный заказ, который доставляется).

3.OrderAnalysis - класс для анализа заказов и создания отчета.
Представлен тремя методами:
1) calculateTotalForMonths(List<Order> orders) - вычисляет общую сумму заказов для каждого месяца.
   orders - список заказов для анализа; @return Map-у, где ключ - месяц, а значение - общая сумма заказов за месяц
2) findMaxTotalMonths(Map<Month, BigDecimal> totalByMonthMap) - находит месяцы с наибольшей общей суммой заказов.
   @return список месяцев с максимальной суммой заказов.
3) createReport(List<Order> orders) - создает отчет в формате JSON, содержащий сортированные по порядку 
месяцы с максимальной общей суммой заказов.
@return отчет в формате JSON.

4.JsonWorker - класс, осуществляющий работу с JSON-файлами. Имеет поле pathOfJson -  путь к json-файлу.
Методы:
1) getOrdersFromFile() - метод получения объектов класса Order из JSON-файла
   @return список заказов, считанный из файла.
2) createReportFile(String report) - создает файл отчета и записывает в него переданный отчет в формате JSON.
@param report отчет, который нужно записать в файл

5.Main - основной класс, отображающий работу программы.

## Инструкция по сборке и запуску решения
1.Установить Maven при необходимости.

2.Сборка проекта:
1) Откройте командную строку (терминал) в директории с файлом pom.xml.
2) Выполните команду: mvn clean install - компиляция проекта, создание JAR-файла

3.Запуск:

В командной строке (терминале) выполните: mvn exec:java

4.Готово!

              __ __
            ,;::\::\
          ,'/' `/'`/
      _\,: '.,-'.-':.
     -./"'  :    :  :\/,
      ::.  ,:____;__; :-
      :"  ( .`-*'o*',);
       \.. ` `---'`' /
        `:._..-   _.'
        ,;  .     `.
       /"'| |       \
      ::. ) :        :
      |" (   \       |
      :.(_,  :       ;
       \'`-'_/      /
        `...   , _,'
         |,|  : |
         |`|  | |
         |,|  | |
     ,--.;`|  | '..--.
    /;' "' ;  '..--. ))
    \:.___(___   ) ))'
           Garfiled =)`-'-''
