# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:
- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего. Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы. В отчете должны учитываться только завершенные заказы.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«months»: [«march»]} 
   - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в течение года.

## Автор решения
Разнодумова Виктория Алексеевна

## Описание реализации
1. Проект содержит 3 класса (Main - для запуска приложения, Report - для генерации отчетов и работы с ними, Order - для хранения и парсинга заказов) и 2 перечисления (OrderStatuses - для хранения состояний заказов, Months - для обработки месяцев).
2. В начале работы программа считывает содержимое файла format.json и преобразует его в массив JSON, который передается в статический метод parseOrders() класса Order, который хранит данные каждого заказа после парсинга. Метод parseOrders() принимает массив JSON, и для каждого его объекта преобразует поля в удобный для работы формат. Поле status хранится в виде перечислений OrderStatuses. Метод возвращает список типа Order. 
3. Создаём новый отчёт - объект класса Report для поиска месяца с наибольшими тратами. Для формирования отчёта используется функция generateMaxTotalMonthReport(), возвращающая строку в формате JSON.
4. Внутри функции создаётся словарь totalForMonths, который будет хранить месяц и сумму заказов. Затем начинаем итерироваться по всем заказам из нашего списка заказов и выполняем проверку на статус. Если он соответствует COMPLETED, то для него получаем месяц. Далее проверяем, был ли месяц уже добавлен в наш словарь. Если да, то для суммарного значения переменной double totalForMonth берём уже записанное в словарь значение, в противном случае присваиваем переменной 0.0. В результате обновляем наш словарь: добавляем в него пару ключу - текущий месяц, значение - старое значение totalForMonth из словаря плюс поле total текущего объекта Order, которое получаем с помощью гетэра.
5. Далее выполняется поиск максимального значения суммы total. Проходимся по всем значениям из словаря totalForMonths и сравниваем их с максимальным maxTotal, который проинициализирован значением Double.MIN_VALUE. Таким образом получаем максимальное значение.
6. Создаём список всех месяцев maxTotalForMonths, для которых сумма оказалась равна найденному maxTotal. Если найдено несколько месяцев, то необходимо обеспечить вывод в порядке их следования в течение года. Для этого проходим по значениям перечисления Months и проверяем, была ли в указанный месяц максимальная сумма. Если да, то преобразуем значение из Months в строку и добавляем в список.
7. В конце создаём объект JSON и добавляем в него найденные значения. Таким образом, функция generateMaxTotalMonthReport() возвращает строку в формате JSON, которая в классе Main выводится на экран. 
## Инструкция по сборке и запуску решения 
Для запуска необходим maven-сборщик с официального сайта.
1. В командной строке необходимо прописать команду для копирования репозитория: git clone https://github.com/victoriaraznodumova/school2024-test-task1.git
2. В корневой директории проекта нужно прописать команду для сборки проекта: mvn clean package
3. Команда для запуска приложения: mvn exec:java

