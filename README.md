# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:
- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего. Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы. В отчете должны учитываться только завершенные заказы.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«months»: [«march»]} 
   - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в течение года.

## Автор решения
Семенов Марсель Евгеньевич

## Описание реализации
Решение предоставлено на языке Java.
Используемые библиотеки: Lombok, Jackson.
В коде будет описано всё также как и ниже, только в виде комментариев.

Первым делом создаю папку data, куда помещаю файл format.json из которого будут браться данные.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/a384c75a-1207-4673-a37f-522150965161)

Далее создаю класс Client в котором прописываю поля из которых будет состоять будущий объект клиента, c помощью аннотаций из библиотеки Lombok создаю геттеры, сеттеры и 2 конструктора.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/21536264-9426-44aa-a900-2e9781320626)

Затем создаю класс DataAnalytics. В нём я создаю метод getAnalytics() в котором будет вся логика.
Инциализрую переменную в которой содержится путь до файла с анализируемыми данными и также создаю объект класса ObjectMapper чтобы прочитать json файл.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/cf2762f9-1f8e-41f3-92fc-04141cfc9c7b)

Читаю данные клиентов из файла и преобразовываю их в объекты типа Client, соответствующие раннее созданному классу.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/1793dcc3-29af-42be-98dd-207357dc32ed)

Создаю мару в которой буду хранить месяцы и суммы, которые клиенты потратили за этот месяц, после прохожусь по каждому клиенту из списка и вытаскиваю месяц, сразу приводя его к строчному типу и нижнему регистру, потому что в Java объекты типа Month записываются в верхнем регистре. Далее проверяю завершённый ли у клиента заказ и если это так, добавляю его сумму к общей сумме трат за месяц. В конце добавляю месяцы с их общей суммой трат в раннее созданную мапу.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/fe3e0831-ef22-472e-87cb-be0200b371d7)

После нахожу среди всех месяцев один или несколько, в которые клиенты потратили больше всего.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/8a8fafd3-d716-48e7-a406-b564914d0eaa)

Теперь создаю список в который буду добавлять название месяца(-ев) когда было потрачено больше всего.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/ff93baca-7afc-4851-86bb-66173c18ad18)

Прохожусь по мапе с месяцами и тратами, сопоставляя максимальное значение из трат с тем, в какой месяц они были сделаны. После добавляю название месяца(-ев) в список.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/fbb3a709-a72f-4f3b-b4d0-60646c8d115c)

Создаю компоратор, чтобы сравнивать месяца по их значению в течение года и тем самым отсортировать.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/84de4da6-b7cb-420d-9e49-47347e2f736b)

Преобразую названия месяцев обратно в объект Month, сортирую месяцы по их порядку в году и после преобразую объект Month в строку приводя к нижнему ренистру.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/ac36f2d0-3473-4cb4-9cbe-2eda76e6b8dc)

В конце концов создаю переменнцю в которую записываю полученные названия месяцев в соответствии с требованиями и возвращаю её.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/739e75fa-4474-4ec1-8f11-7f07ea77035e)

Метод написан. Перехожу в класс Main чтобы проверить что всё работает.
Создаю экземпляр класса DataAnalytics, чтобы получить доступ к методу getAnalytics() и затем вывожу результат в консоль.

![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/1eb52372-6bef-48c6-92dc-da1e43d6e9e1)


## Инструкция по сборке и запуску решения
1. Открыть проект в вашей среде разработки
2. Перейти в натройки компиляторя(в моём случае Intelij IDEA), перейти в раздел Compiler -> Annotation Processor, поставить галочку в поле Enable annotation processing и нажать Apply
   
   ![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/89a8fca1-b07c-4740-88ff-e5a3dbfa7f6f)

4. Откройте папку src и перейдите в класс Main
5. Запустите код и наблюдайте вывод в консоли

**ВАЖНО: чтобы работать с другими данными замените содержимоет файла format.json, который находится в папке data!**

***Также предоставляю инструкцию по установке нужных библиотек***
1. Скачай 4 библиотеки:
   
   https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind

   https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core

   https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-annotations

   https://mvnrepository.com/artifact/org.projectlombok/lombok

3. Выбираете нужную версию(можно просто самую последнюю) и скачиваете jar файл
4. Переходите в проект, открываете Project Structure -> Libraries и нажимаете "+" чтобы добавить библиотеку(и так для всех 4)
   
   ![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/10ba1c10-70e8-4413-962e-a169390deef9)

5. Добавляете скачанные библиотеки, у вас должен получиться такой список
   
   ![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/84dfa886-d413-4edf-a7dd-eb9f14552cbe)

6. После переходите в раздел Models, ставите галочки напротив всех добавленных библиотек и кликаете Apply

   ![изображение](https://github.com/slattchrome/school2024-test-task1/assets/112937058/4a208688-645f-4210-a1da-d4a8a0b866c9)
