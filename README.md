# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о периодах наибольших трат со стороны пользователей.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о покупках пользователей, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Идентификатор пользователя;
- Дата и время оформления заказа;
- Статус заказа;
- Сумма заказа.

В пояснительной записке к массиву данных была уточняющая информация относительно статусов заказов:
- COMPLETED (Завершенный заказ);
- CANCELED (Отмененный заказ);
- CREATED (Созданный заказ, еще не оплаченный);
- DELIVERY (Созданный и оплаченный заказ, который доставляется).

Необходимо разработать отчет, вычисляющий по полученному массиву данных месяц, когда пользователи тратили больше всего. Если максимальная сумма пользовательских трат была в более, чем одном месяце, отчет должен показывать все такие месяцы. В отчете должны учитываться только завершенные заказы.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«months»: [«march»]} 
   - {«months»: [«march», «december»]}
4. Найденный в соответствии с условием задачи месяц должен выводиться на английском языке в нижнем регистре. Если месяцев несколько, то на вывод они все подаются на английском языке в нижнем регистре в порядке их следования в течение года.

## Автор решения
Кочетова Светлана Алексеевна
## Описание реализации
**Purchase** - класс, являющийся моделью заказов со всеми необходимыми полями  
**Status** - enum всех существующих статусов заказа  
**JsonConverter** - класс, отвечающий за получение листа заказов из json файла и конвертацию месяцев в строку в формате json
следующего формата:  
     {"months": ["march"]}  
     {"months": ["march", "december"]}  
**LocalDateTimeDeserializer**, **StatusDeserializer** - классы, необходимые для регистрации typeAdapters для **LocalDateTime** и
enum **Status**, тк **Status**- наш кастомный тип, а для **LocalDateTime** не предусмотрено такого адаптера в GSON  
**ReportGenerator** - класс, отвечающий за обработку пришедшего листа заказов(**Purchase**), возвращает список месяцев    
**Main** - точка входа  

- В main класса Main происходит считывание названия файла с заказами, затем вызывается метод getReport, который формирует отчет
- В методе getReport помощью JsonConverter и его метода getPurchasesFromJson происходит получение данных из json файла
  в лист объектов Purchase - для этого JsonConverter под капотом использует библиотеку Gson
- Затем происходит вызов метода generateMonthsList класса ReportGenerator, в который мы передаем полученный лист
- объектов Purchase, данный метод возвращает обработанные названия месяцев. Затем, вызвав метод convertMonthsToJson класса
- JsonConverter, возвращаем строку, состоящую из месяцев в формате json

*Логика метода generateMonthsList класса ReportGenerator*

Происходит обработка пришедшего в метод листа с помощью Stream API:
1. фильтрация заказов по COMPLETED статусу
2. подсчет общей суммы трат для каждого месяца(использование для хранения данных- Map, где ключ - номер месяца,
   значение - общая сумма)
3. нахождение максимальной суммы трат
4. поиск месяцев, общая сумма трат которых равна максимальной сумме трат
5. сортировка найденных месяцев в порядке их следования в течение года, преобразование их в названия на английском языке
   в нижнем регистре
6. Возврат обработанных месяцев
## Инструкция по сборке и запуску решения
Импортируем данный репозиторий к себе на компьютер  
Запускаем Main в среде разработки  
Вводим в консоль полный путь до файла с заказами, например: /home/kochetova/IdeaProjects/school2024-test-task1/src/format.json   
